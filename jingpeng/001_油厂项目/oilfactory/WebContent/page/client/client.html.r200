<!DOCTYPE html>
<html>

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link href="../../css/basic_layout.css" rel="stylesheet" type="text/css">
		<link href="../../css/common_style.css" rel="stylesheet" type="text/css">
		<link href="../../css/zTreeStyle.css" rel="stylesheet" type="text/css">
		<link rel="stylesheet" type="text/css" href="../../css/bootstrap.css" />
		<link rel="stylesheet" type="text/css" href="../../css/bootstrap-theme.css" />
		<link rel="stylesheet" type="text/css" href="../../css/jquery.fancybox-1.3.4.css" media="screen" /></link>
	    <script type="text/javascript" src="../../js/jquery/jquery-1.7.1.js"></script> 
		<script type="text/javascript" src="../../js/zTree/jquery.ztree.core-3.2.js"></script>
		<script type="text/javascript" src="../../js/common.js"></script>
		<script type="text/javascript" src="../../js/authority/commonAll.js"></script>
		<script type="text/javascript" src="../../js/fancybox/jquery.fancybox-1.3.4.js"></script>
		<script type="text/javascript" src="../../js/fancybox/jquery.fancybox-1.3.4.pack.js"></script>
		<script type="text/javascript" src="../../js/artDialog/artDialog.js?skin=default"></script>
		<script type="text/javascript" src="../../DataTables/datatables.js"></script>
		<link rel="stylesheet" type="text/css" href="../../DataTables/datatables.css" /></link>
		<script type="text/javascript" src="../../js/oilfactory/client/client.js"></script>
		<script type="text/javascript" src="../../js/LodopFuncs.js"></script>
		<script type="text/javascript" src="../../js/sweet-alert.min.js"></script>
		<link rel="stylesheet" href="../../css/sweet-alert.css">
		<title>瑞德公路管理系统</title>
		<script type="text/javascript">
			/** 新增   **/

			/** ----------------leftMenu zTree部分开始----------------  **/
	/* 	jQuery.browser = {};
		jQuery.browser.msie = false;
        jQuery.browser.version = 0;
        if (navigator.userAgent.match(/MSIE ([0-9]+)\./)) {
            jQuery.browser.msie = true;
            jQuery.browser.version = RegExp.$1;
        }
			var zTree;
			var setting = {
					data : {
		    			simpleData : {
		    				enable : true,
		    			}
		    		},
		    		edit : {
		    			enable : true
		    		},
		    	 	callback: {
		    			onClick: findClick
		    		} 
			};

			var nodes = [];
		
			$(document).ready(
	    			function() {
	    				$.getJSON(baseUrl + '/client/getClient_back.action',
	    						function(data) {
	    							console.log(data);
	    							date = data.list;
	    							if (data != null && data.list.length > 0) {
	    								var pid = 0;
	    								var ppid = '';
	    								var node = {};
	    								node = {
	    									id : "客户信息",
	    									pId : 0,
	    									name : "客户信息"
	    								};
	    								nodes.push(node);

	    								for (var i = 0; i < date.length; i++) {
	    									if (date[i].ProvinceId != pid) {
	    										pid = "客户信息";
	    										if (date[i].Province != null
	    												&& date[i].Province != '') {
	    											node = {
	    												id : date[i].Province,
	    												pId : pid,
	    												name : date[i].Province
	    											};
	    											nodes.push(node);
	    											ppid = date[i].Province;
	    										}

	    										if (date[i].CustomerCode != null
	    												&& date[i].CustomerCode != '') {
	    											node = {
	    												id : date[i].Id,
	    												pId : ppid,
	    												name : date[i].CustomerCode
	    											};
	    											nodes.push(node);
	    										}

	    										pid = date[i].ProvinceId;

	    									} else {
	    										node = {
	    											id : date[i].Id,
	    											pId : ppid,
	    											name : date[i].CustomerCode
	    										};
	    										nodes.push(node);
	    									}

	    								}
	    							}
	    							$.fn.zTree.init($("#tree"), setting, nodes);
	    							zTree = $.fn.zTree.getZTreeObj("tree");
	    							console.log(nodes);
	    							zTree.expandAll(true);
	    						});
	    			});
	    	function findClick(event, treeId, treeNode, isCancel) {
	    		var id = treeNode.id;
	    		var pid = treeNode.pId;
	    		findClickByName(id, pid);
	    	} */
			/** ----------------leftMenu  zTree部分开始----------------  **/
		</script>

		<script type="text/javascript">
			$(document).ready(function() {
				$("#addBtn").fancybox({
					'href': 'client_edit.html',
					'width': 800,
					'height': 420,
					'type': 'iframe',
					'hideOnOverlayClick': false,
					'showCloseButton': false,
					'onClosed': function() {
						window.location.href = 'client.html';
					}
				});
				//点击复制
				$('#copy').fancybox({
					onStart: function() {
						var val = $('input[type=radio]:checked').val();
						if(!val) {
							alert('请选择要复制的客户信息！');
							return false;
						}
					},
					'href': 'client_edit.html',
					'width': 800,
					'height': 420,
					'type': 'iframe',
					'hideOnOverlayClick': false,
					'showCloseButton': false,
					'onClosed': function() {
						window.location.href = 'client.html';
					}
				});
				$('.shouqi').click(function() {
					$('#sider').removeClass('show');
					$('#sider').addClass('hiden');
					$('#box_top').hide();
					$('#tree').hide();
					$('#main').removeClass('mshow');
					$('#main').addClass('mhide');
					$('.zhankai').show();
					$('.shouqi').hide();
				})
				$('.zhankai').click(function() {
					$('#sider').removeClass('hiden');
					$('#sider').addClass('show');
					$('#box_top').show();
					$('#tree').show();
					$('#main').removeClass('mhide');
					$('#main').addClass('mshow');
					$('.zhankai').hide();
					$('.shouqi').show();
				})
				//导出
				$("#export").click(function(){
					window.location.href="javascript:SaveAsFile();";
				});
			});
			//切换客户信息、拜访记录、回访记录
			function changePage(data) {
				var hrefChange = $(data).find("option:selected").val();
				location.href = hrefChange;
			}
		</script>
		<style type="text/css">
			.ui_input_txt02 {
				width: 130px;
			}
			/* 平板 */
			@media screen and (min-width:600px) and (max-width:985px){
				.show {
					position: absolute;
					top: 40px;
					left: 0px;
					bottom: 0px;
					width: 200px;
					border: 1px solid #DEDFDF;
					overflow: auto;
				}
				.hiden{
					position: absolute;
					top: 40px;
					left: 0px;
					bottom: 0px;
					width: 20px;
					overflow: auto;
    				border: none;
				}
				.mshow {
					position: absolute;
					top: 40px;
					left: 205px;
					right: 10px;
					bottom: 0px;
					border: 1px solid #DEDFDF;
					overflow: auto;
				}
				.mhide{
					position: absolute;
					top: 40px;
					left: 20px;
					right: 10px;
					bottom: 0px;
					border: 1px solid #DEDFDF;
					overflow: auto;
				}
				.dataTables_scrollBody{
					height: 260px
				}
				
			}
			/* pc */
			@media screen and (min-width:985px){
				.show {
					position: absolute;
					top: 70px;
					left: 0px;
					bottom: 0px;
					width: 260px;
					border: 1px solid #DEDFDF;
					overflow: auto;
				}
				.hiden{
					position: absolute;
					top: 70px;
					left: 0px;
					bottom: 0px;
					width: 20px;
					overflow: auto;
    				border: none;
				}
				.mshow {
					position: absolute;
					top: 70px;
					left: 265px;
					right: 10px;
					bottom: 0px;
					border: 1px solid #DEDFDF;
					overflow: auto;
				}
				.mhide{
					position: absolute;
					top: 70px;
					left: 20px;
					right: 10px;
					bottom: 0px;
					border: 1px solid #DEDFDF;
					overflow: auto;
				}
				.dataTables_scrollBody{
					height: 600px
				}
				
			}
		</style>
	</head>

	<body>
		<form id="submitForm" name="submitForm" action="" method="post" enctype="multipart/form-data">
			<div id="container">
				<div id="top_nav">
					<span id="here_area" style="float: left;">当前位置：系统&nbsp;>&nbsp;销售管理&nbsp;>&nbsp;
						<span style="color:#1A5CC6">
							<select name="" style="width: 120px;height: 30px;" onchange="changePage(this)">
								<option value="client.html" >客户信息</option>
								<option value="client_visit.html">客户拜访信息</option>
								<option value="client_back_visit.html">客户回访信息</option>
							</select>
						</span>
					</span>
				</div>
				<div id="sider" class="show">
					<a class="shouqi" href="javascript:;" title="收起菜单"></a>
					<a class="zhankai" href="javascript:;" title="展开菜单"></a>
					<div id="box_top">客户信息</div>
					<ul id="tree" class="ztree"></ul>
				</div>
				<div id="main" class="mshow">
					<div class="ui_tb">
						<div id="box_border">
							<div id="box_top">客户信息</div>
							<div id="box_center" class="col-lg-12 col-sm-12 ">
								<div class="col-lg-6 col-sm-6">
									客户编号：&nbsp;&nbsp;<input type="text" id="customercode" name="customercode" class="ui_input_txt02" />
									客户名称：&nbsp;&nbsp;<input type="text" id="customername" name="customername" class="ui_input_txt02" />
									<input type="button" value="查询" style="margin-left: 20px;margin-top: 2px;" class="ui_input_btnsearch" onclick="search();" />
								</div>	
								<div class="col-lg-6 col-sm-6"> 
									<!-- <input type="button" style="float: right;" value="导出" class="ui_input_btnexport" id="export" /> -->
									<input type="button" style="float: right;" value="新增客户" class="ui_input_btnadd" id="addBtn" />
								</div>
							</div>
							<div class="col-lg-12 col-sm-12" style="overflow-x: auto;">
								<table class="table table-striped" id="clientList" style="width: 2370px;" cellspacing="0" cellpadding="0" align="center" border="0">
									<thead>
									<tr>
										<th width="100px" class="xuhao">序号</th>
										<th width="100px" class="caozuo">操作</th>
										<th width="150px" class="kehumingcheng">客户编号</th>
										<th width="150px" class="kehumingcheng">客户名称</th>
										<th width="150px" class="suoshudi">所属省</th>
										<th width="150px" class="suoshudi">所属市</th>
										<th width="150px" class="suoshudi">意向客户级别</th>
										<th width="150px" class="suoshudi">采购级别</th>
										<th width="150px" class="suoshudi">诚信级别</th>
										<th width="200px" class="beizhu">地址</th>
										<th width="150px" class="xiaoshouyuan">联系人</th>
										<th width="200px" class="dianhua">联系电话</th>
										<th width="200px" class="dianhua">其他联系方式</th>
										<th class="beizhu">备注</th>
									</tr>
									</thead>
									<tbody>
									</tbody>
							</table>
						</div>
						</div>
						<div id="box_border1">
							<div id="box_top">客户信息</div>
							<!-- <div id="box_center" class="col-lg-12 col-sm-12 ">
							<div class="col-lg-6 col-sm-6">
									客户名称：&nbsp;&nbsp;<input type="text" id="fyZldz2" name="fangyuanEntity.fyZldz" class="ui_input_txt02" /><input type="button" value="查询" style="margin-left: 20px;margin-top: 2px;" class="ui_input_btnsearch" onclick="search();" /> 
								</div>	
								<div class="col-lg-6 col-sm-6"> 
									<input type="button" style="float: right;" value="导出" class="ui_input_btnexport" id="export" />
									<input type="button" style="float: right;" value="新增客户" class="ui_input_btnadd" id="addBtn" />
								</div>
							</div> -->
							<div style="overflow-x: auto;"class="col-lg-12 col-sm-12 ">
								<table class="table table-striped" id="clientList1" style="width: 2370px;" cellspacing="0" cellpadding="0" align="center" border="0">
									<thead>
									<tr>
										<th class="xuhao">序号</th>
										<th class="kehumingcheng">客户名称</th>
										<th class="suoshudi">所属省</th>
										<th class="suoshudi">所属市</th>
										<th class="suoshudi">意向客户级别</th>
										<th class="suoshudi">采购级别</th>
										<th class="suoshudi">诚信级别</th>
										<th class="beizhu">地址</th>
										<th class="xiaoshouyuan">联系人</th>
										<th class="dianhua">联系电话</th>
										<th class="dianhua">其他联系方式</th>
										<th class="beizhu">备注</th>
									</tr>
									</thead>
									<tbody>
									</tbody>
							</table>
						</div>
						</div>
					</div>
				</div>
		</form>
<script> 
	var LODOP; //声明为全局变量   
	function PreviewMytable(){
		var LODOP=getLodop();  
		LODOP.PRINT_INIT("PreviewMytable")
		var strStyle="<style> table,td,th {border-width: 1px;border-style: solid;border-collapse: collapse;}</style>"
		LODOP.NewPageA();
    	LODOP.ADD_PRINT_TABLE(100,"5%","90%",328,strStyle+document.getElementById("box_border1").innerHTML);
    	LODOP.SET_PRINT_STYLEA(0,"FontColor","#FF0000");
		LODOP.PREVIEW();	
	};	
	function SaveAsFile(){ 
		LODOP=getLodop();   
		LODOP.PRINT_INIT("SaveAsFile"); 
		LODOP.ADD_PRINT_TABLE(100,20,500,80,document.getElementById("box_border1").innerHTML); 
		LODOP.SET_SAVE_MODE("Orientation",2); //Excel文件的页面设置：横向打印   1-纵向,2-横向;
		LODOP.SET_SAVE_MODE("PaperSize",9);  //Excel文件的页面设置：纸张大小   9-对应A4
		LODOP.SET_SAVE_MODE("Zoom",100);       //Excel文件的页面设置：缩放比例
		LODOP.SET_SAVE_MODE("CenterHorizontally",true);//Excel文件的页面设置：页面水平居中
		LODOP.SET_SAVE_MODE("CenterVertically",true); //Excel文件的页面设置：页面垂直居中
		LODOP.SAVE_TO_FILE("新文件名.xls"); 0
	};
</script>
	</body>

</html>